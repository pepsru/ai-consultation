<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è | –ù–µ–π—Ä–æ–≥—Ä–∞—Ñ–∏–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #3b82f6;
            --secondary-color: #60a5fa;
            --accent-color: #2563eb;
            --bg-dark: #0a0a0f;
            --bg-card: #1a1a2e;
            --text-primary: #ffffff;
            --text-secondary: #b0b0c0;
            --border-glow: rgba(0, 245, 255, 0.3);
        }

        @keyframes backgroundShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px var(--border-glow); }
            50% { box-shadow: 0 0 40px var(--primary-color); }
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 0, 255, 0.1) 0%, transparent 50%);
            background-size: 100% 100%;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Neural network background - DISABLED for performance */
        .neural-bg {
            display: none;
        }

        .neural-node {
            display: none;
        }

        .container {
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            border: 1px solid rgba(0, 245, 255, 0.2);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 0 60px rgba(0, 245, 255, 0.05);
            max-width: 600px;
            width: 100%;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .header {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.3) 0%, 
                rgba(0, 245, 255, 0.2) 100%);
            padding: 50px 40px;
            text-align: center;
            position: relative;
        }

        .ai-icon {
            font-size: 64px;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
            filter: drop-shadow(0 0 20px var(--primary-color));
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 12px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
        }

        .header p {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            position: relative;
        }

        .form-container {
            padding: 40px;
        }

        .benefits {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.1) 0%, 
                rgba(0, 245, 255, 0.05) 100%);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 245, 255, 0.2);
            position: relative;
        }

        .benefits h3 {
            color: var(--primary-color);
            margin-bottom: 18px;
            font-size: 18px;
            font-weight: 600;
            position: relative;
        }

        .benefits ul {
            list-style: none;
            padding: 0;
            position: relative;
        }

        .benefits li {
            padding: 10px 0;
            color: var(--text-secondary);
            position: relative;
            padding-left: 30px;
        }

        .benefits li::before {
            content: "‚óÜ";
            position: absolute;
            left: 0;
            color: var(--primary-color);
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input, select, textarea {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 245, 255, 0.2);
            border-radius: 15px;
            font-size: 16px;
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 0 20px rgba(0, 245, 255, 0.2),
                inset 0 0 20px rgba(0, 245, 255, 0.05);
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2300f5ff'%3E%3Cpath d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 20px center;
            padding-right: 45px;
        }

        select option {
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 10px;
        }

        .datetime-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .submit-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: var(--text-primary);
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 35px rgba(124, 58, 237, 0.4),
                0 0 30px var(--primary-color);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            padding: 18px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 500;
            display: none;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .success-message {
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.2), 
                rgba(5, 150, 105, 0.2));
            border: 1px solid rgba(16, 185, 129, 0.5);
            color: #10b981;
        }

        .error-message {
            background: linear-gradient(135deg, 
                rgba(239, 68, 68, 0.2), 
                rgba(220, 38, 38, 0.2));
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #ef4444;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s linear infinite;
            margin-left: 10px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .info-text {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 8px;
            font-style: italic;
        }

        .time-slot {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(0, 245, 255, 0.1);
            border: 1px solid rgba(0, 245, 255, 0.3);
            border-radius: 10px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        .time-slot:hover {
            background: rgba(0, 245, 255, 0.2);
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .time-slot.selected {
            background: var(--primary-color);
            color: var(--bg-dark);
            border-color: var(--primary-color);
        }

        .time-slots-container {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        @media (max-width: 600px) {
            .container {
                border-radius: 20px;
            }
            
            .header {
                padding: 40px 25px;
            }
            
            .header h1 {
                font-size: 26px;
            }
            
            .form-container {
                padding: 30px 25px;
            }

            .datetime-group {
                grid-template-columns: 1fr;
            }

            .ai-icon {
                font-size: 48px;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
    </style>
</head>
<body>
    <!-- Neural network background -->
    <div class="neural-bg" id="neuralBg"></div>

    <div class="container">
        <div class="header">
            <div class="ai-icon">üß†</div>
            <h1>AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è</h1>
            <p>–û—Ç–∫—Ä–æ–π—Ç–µ –º–∏—Ä –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –Ω–µ–π—Ä–æ–≥—Ä–∞—Ñ–∏–∫–∏</p>
        </div>
        
        <div class="form-container">
            <div class="benefits">
                <h3>‚óÜ –ß—Ç–æ –≤–∞—Å –∂–¥—ë—Ç</h3>
                <ul>
                    <li>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç—ã —Å AI</li>
                    <li>–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞</li>
                    <li>–°–µ–∫—Ä–µ—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏</li>
                    <li>–ü—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö</li>
                    <li>–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –≤–∞—à–∏—Ö –Ω–∞–≤—ã–∫–æ–≤</li>
                </ul>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö -->
            <div class="benefits" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(96, 165, 250, 0.05) 100%);">
                <h3>‚è∞ –í—Ä–µ–º—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px;">
                    <strong style="color: var(--primary-color);">–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è:</strong> 10:00 - 20:00 (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, UTC+5)
                </p>
                <p style="color: var(--text-secondary); font-size: 14px;" id="timezoneInfo">
                    üìç –í–∞—à —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å: <span id="clientTimezone" style="color: var(--primary-color);">–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</span><br>
                    üïê –°–ª–æ—Ç—ã –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –≤–∞—à–µ–º –≤—Ä–µ–º–µ–Ω–∏
                </p>
            </div>

            <div class="success-message message" id="successMessage">
                ‚úì –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!
            </div>

            <div class="error-message message" id="errorMessage">
                ‚ö† –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π.
            </div>

            <!-- 
            ============================================
            DEBUG INFO BLOCK - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù
            ============================================
            –≠—Ç–æ—Ç –±–ª–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram Mini App.
            –ü–æ–∫–∞–∑—ã–≤–∞–ª:
            - –û—Ç–∫—Ä—ã—Ç–∞ –ª–∏ —Ñ–æ—Ä–º–∞ –≤ Telegram –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–µ
            - User ID, Username, –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
            
            –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏:
            1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –Ω–∏–∂–µ
            2. –í JavaScript –Ω–∞–π–¥–∏—Ç–µ "debugInfo.style.display = 'block';" (—Å—Ç—Ä–æ–∫–∏ ~570 –∏ ~584)
            3. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏
            
            <div id="debugInfo" style="display: none; padding: 15px; background: rgba(59, 130, 246, 0.2); border-radius: 12px; margin-bottom: 20px; font-size: 14px; color: #60a5fa;"></div>
            -->

            <form id="consultationForm">
                <div class="form-group">
                    <label for="fullName">‚óÜ –§–ò–û</label>
                    <input 
                        type="text" 
                        id="fullName" 
                        name="fullName" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –∏–º—è"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="phone">‚óÜ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone" 
                        placeholder="+7 (999) 123-45-67"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="telegram">‚óÜ Telegram</label>
                    <input 
                        type="text" 
                        id="telegram" 
                        name="telegram" 
                        placeholder="@username"
                        required
                    >
                    <p class="info-text" id="telegramInfo">–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å @, –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤</p>
                </div>

                <div class="form-group">
                    <label for="consultationType">‚óÜ –¢–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</label>
                    <select id="consultationType" name="consultationType" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</option>
                        <option value="free">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è (30 –º–∏–Ω.) - 0‚ÇΩ</option>
                        <option value="basic">–ë–∞–∑–æ–≤–∞—è (1 —á–∞—Å) - –æ—Ç 3000‚ÇΩ</option>
                        <option value="advanced">–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è (2 —á–∞—Å–∞) - –æ—Ç 5000‚ÇΩ</option>
                        <option value="intensive">–ò–Ω—Ç–µ–Ω—Å–∏–≤ (4 —á–∞—Å–∞) - –æ—Ç 9000‚ÇΩ</option>
                        <option value="package">–ü–∞–∫–µ—Ç (5 –∑–∞–Ω—è—Ç–∏–π) - –æ—Ç 20000‚ÇΩ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="consultationDate">‚óÜ –ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞</label>
                    <input 
                        type="date" 
                        id="consultationDate" 
                        name="consultationDate"
                        required
                    >
                    <p class="info-text">–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—É—é –¥–∞—Ç—É –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</p>
                </div>

                <div class="form-group">
                    <label>‚óÜ –ñ–µ–ª–∞–µ–º–æ–µ –≤—Ä–µ–º—è</label>
                    <div class="time-slots-container" id="timeSlotsContainer">
                        <!-- –°–ª–æ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã -->
                        <p style="color: var(--text-secondary); font-size: 14px; padding: 15px;">
                            –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ‚òùÔ∏è
                        </p>
                    </div>
                    <input type="hidden" id="selectedTime" name="selectedTime" required>
                    <p class="info-text">–°–ª–æ—Ç—ã –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –≤–∞—à–µ–º —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ</p>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å—ë –∑–∞–Ω—è—Ç–æ) -->
                    <div id="findFreeSlotContainer" style="display: none; margin-top: 15px;">
                        <button type="button" id="findFreeSlotBtn" style="
                            width: 100%;
                            padding: 12px;
                            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
                            color: white;
                            border: none;
                            border-radius: 12px;
                            font-size: 15px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            üîç –ù–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–µ–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="comments">‚óÜ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <textarea 
                        id="comments" 
                        name="comments" 
                        rows="3"
                        placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–∏—Ö —Ü–µ–ª—è—Ö –∏ –æ–∂–∏–¥–∞–Ω–∏—è—Ö –æ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏..."
                    ></textarea>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <span id="btnText">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</span>
                </button>
            </form>
        </div>
    </div>

    <script>
        // ============================================
        // TELEGRAM INTEGRATION
        // ============================================
        // TELEGRAM INTEGRATION
        // ============================================
        let tg = window.Telegram?.WebApp;
        let isTelegramApp = false;
        
        // DEBUG: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –Ω–∏–∂–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        // const debugInfo = document.getElementById('debugInfo');
        
        if (tg && tg.initData) {
            isTelegramApp = true;
            try {
                tg.ready();
                tg.expand();
            } catch (e) {}
            
            const user = tg.initDataUnsafe?.user;
            
            /* 
            ============================================
            DEBUG INFO DISPLAY - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù
            ============================================
            –≠—Ç–æ—Ç –∫–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ Telegram
            –Ω–∞ —Å–∞–º–æ–π —Ñ–æ—Ä–º–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.
            
            –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏:
            1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ HTML –±–ª–æ–∫ debugInfo –≤—ã—à–µ (—Å—Ç—Ä–æ–∫–∞ ~450)
            2. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É "const debugInfo = ..." (—Å—Ç—Ä–æ–∫–∞ ~559)
            3. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –±–ª–æ–∫–∏ –Ω–∏–∂–µ (—Å—Ç—Ä–æ–∫–∏ 571-577 –∏ 593-595)
            
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = `
                üì± <b>Telegram Mini App:</b> –î–ê<br>
                üë§ <b>User ID:</b> ${user?.id || '–Ω–µ—Ç'}<br>
                üî§ <b>Username:</b> ${user?.username ? '@' + user.username : '–ù–ï–¢ USERNAME'}<br>
                üìù <b>–ò–º—è:</b> ${user?.first_name || '–Ω–µ—Ç'} ${user?.last_name || ''}
            `;
            */
            
            // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Telegram
            setTimeout(() => {
                if (user?.username) {
                    telegramInput.value = '@' + user.username;
                }
                if (user?.first_name) {
                    const fullName = user.first_name + (user.last_name ? ' ' + user.last_name : '');
                    const nameInput = document.getElementById('fullName');
                    if (!nameInput.value) {
                        nameInput.value = fullName;
                    }
                }
            }, 300);
        } 
        /* 
        ============================================
        DEBUG –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù
        ============================================
        else {
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = 'üåê <b>–ë—Ä–∞—É–∑–µ—Ä:</b> —Ñ–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ';
        }
        */

        // ============================================
        // –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ß–ê–°–û–í–û–ì–û –ü–û–Ø–°–ê –ö–õ–ò–ï–ù–¢–ê
        // ============================================
        
        const MY_TIMEZONE_OFFSET = 300; // UTC+5 –≤ –º–∏–Ω—É—Ç–∞—Ö (5 * 60 = 300)
        const WORK_START_HOUR = 10; // –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è (–≤ –≤–∞—à–µ–º –≤—Ä–µ–º–µ–Ω–∏)
        const WORK_END_HOUR = 20;   // –ö–æ–Ω–µ—Ü —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
        
        // –ü–æ–ª—É—á–∞–µ–º —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –∫–ª–∏–µ–Ω—Ç–∞
        const clientTimezoneOffset = -new Date().getTimezoneOffset(); // –í –º–∏–Ω—É—Ç–∞—Ö
        const clientTimezoneName = Intl.DateTimeFormat().resolvedOptions().timeZone;
        
        // –†–∞–∑–Ω–∏—Ü–∞ –≤ —á–∞—Å–∞—Ö –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –≤–∞–º–∏
        const timeDifferenceMinutes = clientTimezoneOffset - MY_TIMEZONE_OFFSET;
        const timeDifferenceHours = timeDifferenceMinutes / 60;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ
        const clientTimezoneEl = document.getElementById('clientTimezone');
        if (clientTimezoneEl) {
            const utcOffset = clientTimezoneOffset / 60;
            const sign = utcOffset >= 0 ? '+' : '';
            clientTimezoneEl.textContent = `${clientTimezoneName} (UTC${sign}${utcOffset})`;
        }
        
        console.log('üåç –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞:', {
            client: clientTimezoneName,
            clientOffset: clientTimezoneOffset,
            myOffset: MY_TIMEZONE_OFFSET,
            difference: timeDifferenceHours + ' —á–∞—Å–æ–≤'
        });
        
        // ============================================
        // –§–£–ù–ö–¶–ò–Ø –ö–û–ù–í–ï–†–°–ò–ò –í–†–ï–ú–ï–ù–ò
        // ============================================
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤–∞—à–µ –≤—Ä–µ–º—è –≤ –≤—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
        function convertMyTimeToClient(myHour) {
            return myHour + timeDifferenceHours;
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ –≤–∞—à–µ –≤—Ä–µ–º—è
        function convertClientTimeToMy(clientHour) {
            return clientHour - timeDifferenceHours;
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function formatTime(hour) {
            const h = Math.floor(hour);
            const m = Math.round((hour - h) * 60);
            return (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m;
        }

        // Form elements
        const form = document.getElementById('consultationForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const phoneInput = document.getElementById('phone');
        const telegramInput = document.getElementById('telegram');
        const dateInput = document.getElementById('consultationDate');
        // const timeSlots = document.querySelectorAll('.time-slot'); // –ù–µ –Ω—É–∂–Ω–æ - —Å–ª–æ—Ç—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
        const selectedTimeInput = document.getElementById('selectedTime');

        // Set minimum date to tomorrow (–∑–∞–ø–∏—Å—å –º–∏–Ω–∏–º—É–º –∑–∞ 24 —á–∞—Å–∞)
        const now = new Date();
        const tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const today = now.getFullYear() + '-' + 
                      String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                      String(now.getDate()).padStart(2, '0');
        
        const minDate = tomorrow.getFullYear() + '-' + 
                        String(tomorrow.getMonth() + 1).padStart(2, '0') + '-' + 
                        String(tomorrow.getDate()).padStart(2, '0');
        
        dateInput.setAttribute('min', minDate);

        // ============================================
        // –û–ë–†–ê–ë–û–¢–ö–ê –ü–ê–ö–ï–¢–ù–û–ô –ö–û–ù–°–£–õ–¨–¢–ê–¶–ò–ò
        // ============================================
        const consultationTypeSelect = document.getElementById('consultationType');
        const timeSlotsContainer = document.getElementById('timeSlotsContainer');
        
        consultationTypeSelect.addEventListener('change', function() {
            if (this.value === 'package') {
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ —Å–ª–æ—Ç—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                timeSlotsContainer.innerHTML = `
                    <div style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(96, 165, 250, 0.05) 100%);
                        border-radius: 12px;
                        border: 1px solid rgba(59, 130, 246, 0.2);
                    ">
                        <p style="color: var(--primary-color); font-weight: 600; margin-bottom: 10px;">
                            üìû –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            –≠—Ç–æ—Ç —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –æ–±—Å—É–∂–¥–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É, –∏ –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–µ –∑–∞–Ω—è—Ç–∏–π.
                        </p>
                    </div>
                `;
                selectedTimeInput.value = 'package'; // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–∞–∫–µ—Ç–∞
                selectedTimeInput.removeAttribute('required');
            } else {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                selectedTimeInput.value = '';
                selectedTimeInput.setAttribute('required', 'required');
                
                // –ï—Å–ª–∏ –¥–∞—Ç–∞ —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–æ—Ç—ã
                if (dateInput.value) {
                    const event = new Event('change', { bubbles: true });
                    dateInput.dispatchEvent(event);
                } else {
                    timeSlotsContainer.innerHTML = '<p style="color: var(--text-secondary); font-size: 14px; padding: 15px;">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ‚òùÔ∏è</p>';
                }
            }
        });

        // Phone formatting
        phoneInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 0) {
                if (value[0] === '7' || value[0] === '8') {
                    value = '7' + value.substring(1);
                } else if (value[0] !== '7') {
                    value = '7' + value;
                }
                
                let formatted = '+7';
                if (value.length > 1) {
                    formatted += ' (' + value.substring(1, 4);
                }
                if (value.length >= 5) {
                    formatted += ') ' + value.substring(4, 7);
                }
                if (value.length >= 8) {
                    formatted += '-' + value.substring(7, 9);
                }
                if (value.length >= 10) {
                    formatted += '-' + value.substring(9, 11);
                }
                
                e.target.value = formatted;
            }
        });

        // Telegram username validation
        telegramInput.addEventListener('input', function(e) {
            let value = e.target.value;
            
            if (value && !value.startsWith('@')) {
                value = '@' + value;
            }
            
            let username = value.substring(1);
            username = username.replace(/[^a-zA-Z0-9_]/g, '');
            
            if (username.length > 0 && /^\d/.test(username)) {
                username = username.substring(1);
            }
            
            e.target.value = username ? '@' + username : '';
            
            if (username.length >= 5) {
                e.target.style.borderColor = 'var(--primary-color)';
            } else if (username.length > 0) {
                e.target.style.borderColor = '#fbbf24';
            } else {
                e.target.style.borderColor = 'rgba(0, 245, 255, 0.2)';
            }
        });

        // ============================================
        // TIME SLOT HANDLERS
        // ============================================
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ —Ç–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
        // –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª–æ—Ç–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

        // ============================================
        // –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –°–õ–û–¢–û–í –° –ö–û–ù–í–ï–†–°–ò–ï–ô
        // ============================================
        dateInput.addEventListener('change', async function() {
            const selectedDate = this.value;
            if (!selectedDate) return;
            
            const timeSlotsContainer = document.getElementById('timeSlotsContainer');
            const findFreeSlotContainer = document.getElementById('findFreeSlotContainer');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            timeSlotsContainer.innerHTML = '<p style="color: var(--primary-color); font-size: 14px; padding: 15px;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤...</p>';
            timeSlotsContainer.style.opacity = '0.5';
            timeSlotsContainer.style.pointerEvents = 'none';
            findFreeSlotContainer.style.display = 'none';
            
            try {
                const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxX9Y_FN0YV54P-b3oTFUwmaszgQ2YGBJ9-US4s3MgAExHfDH8Ba7ZgKKkMjmdB7SEj/exec';
                const response = await fetch(
                    `${GOOGLE_SCRIPT_URL}?action=checkAvailability&date=${selectedDate}&clientOffset=${clientTimezoneOffset}`
                );
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    const now = new Date();
                    const currentHourClient = now.getHours();
                    const currentMinuteClient = now.getMinutes();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ –ª–∏ –ø—Ä–æ—à–ª–∞—è –¥–∞—Ç–∞
                    const selectedDateObj = new Date(selectedDate + 'T00:00:00');
                    const todayDateObj = new Date(today + 'T00:00:00');
                    const isPastDate = selectedDateObj < todayDateObj;
                    const isToday = selectedDate === today;
                    
                    // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –ø—Ä–æ—à–ª–∞—è –¥–∞—Ç–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    if (isPastDate) {
                        timeSlotsContainer.innerHTML = '<p style="color: #ef4444; font-size: 14px; padding: 15px;">‚ö†Ô∏è –ù–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ—à–µ–¥—à—É—é –¥–∞—Ç—É</p>';
                        return;
                    }
                    
                    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å–ª–æ—Ç—ã
                    timeSlotsContainer.innerHTML = '';
                    
                    let freeCount = 0;
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –í–°–ï —Å–ª–æ—Ç—ã (—Å–≤–æ–±–æ–¥–Ω—ã–µ + –∑–∞–Ω—è—Ç—ã–µ)
                    data.allSlots.forEach(myTimeSlot => {
                        const [myHour, myMinute] = myTimeSlot.split(':').map(Number);
                        
                        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –≤—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
                        const clientHour = myHour + timeDifferenceHours;
                        const clientTime = formatTime(clientHour);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–Ω—è—Ç–æ—Å—Ç—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
                        const isBooked = data.bookedSlots.includes(myTimeSlot);
                        
                        let isDisabled = false;
                        let reason = '';
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ó–∞–Ω—è—Ç–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ (–ü–†–ò–û–†–ò–¢–ï–¢)
                        if (isBooked) {
                            isDisabled = true;
                            reason = '–ó–∞–Ω—è—Ç–æ';
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –≤—Ä–µ–º—è - –º–µ–Ω—å—à–µ 24 —á–∞—Å–æ–≤ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞
                        // (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º)
                        if (!isDisabled) {
                            const slotDateTime = new Date(selectedDate + 'T' + formatTime(clientHour) + ':00');
                            const nowDateTime = new Date();
                            const timeDiffMs = slotDateTime - nowDateTime;
                            const timeDiffMinutes = timeDiffMs / (1000 * 60);
                            const timeDiffHours = timeDiffMinutes / 60;
                            
                            if (timeDiffHours < 24) {
                                isDisabled = true;
                                reason = timeDiffHours < 0 ? '–ü—Ä–æ—à–ª–æ' : '–ú–µ–Ω–µ–µ 24—á';
                            }
                        }
                        
                        // –°–æ–∑–¥–∞—ë–º —ç–ª–µ–º–µ–Ω—Ç —Å–ª–æ—Ç–∞
                        const slotEl = document.createElement('div');
                        slotEl.className = 'time-slot';
                        slotEl.setAttribute('data-time', myTimeSlot);
                        slotEl.setAttribute('data-client-time', clientTime);
                        slotEl.textContent = clientTime;
                        
                        if (isDisabled) {
                            slotEl.classList.add('disabled');
                            slotEl.style.opacity = '0.3';
                            slotEl.style.cursor = 'not-allowed';
                            slotEl.style.pointerEvents = 'none';
                            slotEl.title = reason;
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø—Ä–∏—á–∏–Ω—ã
                            const reasonEl = document.createElement('span');
                            reasonEl.style.display = 'block';
                            reasonEl.style.fontSize = '11px';
                            reasonEl.style.marginTop = '2px';
                            reasonEl.style.color = '#ef4444';
                            reasonEl.textContent = reason;
                            slotEl.appendChild(reasonEl);
                        } else {
                            freeCount++;
                            slotEl.title = `–í–∞—à–µ –≤—Ä–µ–º—è: ${clientTime}\n–í—Ä–µ–º—è –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞: ${myTimeSlot} (UTC+5)`;
                            slotEl.addEventListener('click', function() {
                                if (this.classList.contains('disabled')) return;
                                
                                document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                                this.classList.add('selected');
                                selectedTimeInput.value = this.getAttribute('data-time');
                                selectedTimeInput.setAttribute('data-client-time', this.getAttribute('data-client-time'));
                            });
                        }
                        
                        timeSlotsContainer.appendChild(slotEl);
                    });
                    
                    // –ï—Å–ª–∏ –≤—Å–µ —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç—ã - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞
                    if (freeCount === 0) {
                        findFreeSlotContainer.style.display = 'block';
                    }
                    
                    console.log('‚úÖ –°–ª–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', {
                        total: data.allSlots.length,
                        free: freeCount,
                        booked: data.bookedSlots.length
                    });
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:', error);
                timeSlotsContainer.innerHTML = '<p style="color: #ef4444; font-size: 14px; padding: 15px;">‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.</p>';
            } finally {
                timeSlotsContainer.style.opacity = '1';
                timeSlotsContainer.style.pointerEvents = 'auto';
            }
        });

        // ============================================
        // –ü–û–ò–°–ö –ë–õ–ò–ñ–ê–ô–®–ï–ì–û –°–í–û–ë–û–î–ù–û–ì–û –í–†–ï–ú–ï–ù–ò
        // ============================================
        document.getElementById('findFreeSlotBtn').addEventListener('click', async function() {
            const btn = this;
            const originalText = btn.textContent;
            btn.disabled = true;
            btn.textContent = 'üîç –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏...';
            
            try {
                const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxX9Y_FN0YV54P-b3oTFUwmaszgQ2YGBJ9-US4s3MgAExHfDH8Ba7ZgKKkMjmdB7SEj/exec';
                
                // –ò—â–µ–º –±–ª–∏–∂–∞–π—à—É—é —Å–≤–æ–±–æ–¥–Ω—É—é –¥–∞—Ç—É (–ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ 5 –¥–Ω–µ–π)
                const startDate = new Date(dateInput.value);
                let foundDate = null;
                let foundSlots = null;
                
                for (let i = 1; i <= 5; i++) {
                    const checkDate = new Date(startDate);
                    checkDate.setDate(checkDate.getDate() + i);
                    const dateStr = checkDate.getFullYear() + '-' + 
                                   String(checkDate.getMonth() + 1).padStart(2, '0') + '-' + 
                                   String(checkDate.getDate()).padStart(2, '0');
                    
                    const response = await fetch(
                        `${GOOGLE_SCRIPT_URL}?action=checkAvailability&date=${dateStr}&clientOffset=${clientTimezoneOffset}`
                    );
                    
                    const data = await response.json();
                    
                    if (data.status === 'success' && data.availableSlots.length > 0) {
                        foundDate = dateStr;
                        foundSlots = data;
                        break;
                    }
                }
                
                if (foundDate) {
                    // –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—É—é –¥–∞—Ç—É
                    dateInput.value = foundDate;
                    
                    // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Å–æ–±—ã—Ç–∏–µ change –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–æ—Ç–æ–≤
                    const event = new Event('change', { bubbles: true });
                    dateInput.dispatchEvent(event);
                    
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Å–ª–æ—Ç–∞–º
                    document.getElementById('timeSlotsContainer').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'center' 
                    });
                } else {
                    alert('üòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤—Å–µ —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç—ã –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 5 –¥–Ω–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É –ø–æ–∑–∂–µ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å –Ω–∞–ø—Ä—è–º—É—é.');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error);
                alert('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É –≤—Ä—É—á–Ω—É—é.');
            } finally {
                btn.disabled = false;
                btn.textContent = originalText;
            }
        });

        // Form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Hide previous messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            // Get consultation type first
            const consultationType = document.getElementById('consultationType').value;
            
            // Validate time selection (skip for package)
            if (!selectedTimeInput.value && consultationType !== 'package') {
                errorMessage.textContent = '‚ö† –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏';
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            // Get form data
            const formData = {
                fullName: document.getElementById('fullName').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                telegram: document.getElementById('telegram').value.trim(),
                consultationType: document.getElementById('consultationType').value,
                consultationDate: document.getElementById('consultationDate').value,
                consultationTime: selectedTimeInput.value, // –í–ê–®–ï –≤—Ä–µ–º—è (UTC+5)
                clientTime: selectedTimeInput.getAttribute('data-client-time') || selectedTimeInput.value, // –í—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
                clientTimezone: `${clientTimezoneName} (UTC${clientTimezoneOffset >= 0 ? '+' : ''}${clientTimezoneOffset / 60})`,
                clientTimezoneOffset: clientTimezoneOffset,
                comments: document.getElementById('comments').value.trim(),
                timestamp: new Date().toISOString()
            };
            
            // Validate
            if (!formData.fullName || !formData.phone || !formData.telegram || 
                !formData.consultationType || !formData.consultationDate) {
                errorMessage.textContent = '‚ö† –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è';
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–ª—è –ø–∞–∫–µ—Ç–∞)
            if (formData.consultationType !== 'package') {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã - –º–∏–Ω–∏–º—É–º –∑–∞–≤—Ç—Ä–∞
                const now = new Date();
                const selectedDateObj = new Date(formData.consultationDate + 'T00:00:00');
                const tomorrowDateObj = new Date(now);
                tomorrowDateObj.setDate(tomorrowDateObj.getDate() + 1);
                tomorrowDateObj.setHours(0, 0, 0, 0);
                
                if (selectedDateObj < tomorrowDateObj) {
                    errorMessage.textContent = '‚ö† –ó–∞–ø–∏—Å—å –≤–æ–∑–º–æ–∂–Ω–∞ –º–∏–Ω–∏–º—É–º –∑–∞ 24 —á–∞—Å–∞';
                    errorMessage.style.display = 'block';
                    errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ - –º–∏–Ω–∏–º—É–º 24 —á–∞—Å–∞ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞
                const [selectedHour, selectedMinute] = formData.consultationTime.split(':').map(Number);
                const consultationDateTime = new Date(formData.consultationDate + 'T' + formData.consultationTime + ':00');
                const timeDiffMs = consultationDateTime - now;
                const timeDiffHours = timeDiffMs / (1000 * 60 * 60);
                
                if (timeDiffHours < 24) {
                    errorMessage.textContent = '‚ö† –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º—É–º 24 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏';
                    errorMessage.style.display = 'block';
                    errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
            }
            
            // Telegram username validation
            const telegramUsername = formData.telegram.substring(1);
            const telegramInfo = document.getElementById('telegramInfo');
            const telegramField = document.getElementById('telegram');
            
            if (!formData.telegram.startsWith('@') || telegramUsername.length < 5) {
                telegramInfo.textContent = '‚ö† –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å @ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤';
                telegramInfo.style.color = '#ef4444';
                telegramField.style.borderColor = '#ef4444';
                telegramField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            if (!/^[a-zA-Z0-9_]+$/.test(telegramUsername)) {
                telegramInfo.textContent = '‚ö† –¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ _';
                telegramInfo.style.color = '#ef4444';
                telegramField.style.borderColor = '#ef4444';
                telegramField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            // –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π –µ—Å–ª–∏ –≤—Å—ë –æ–∫
            telegramInfo.textContent = '–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å @, –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤';
            telegramInfo.style.color = 'var(--text-secondary)';
            telegramField.style.borderColor = 'rgba(0, 245, 255, 0.2)';
            
            // Disable button and show loading
            submitBtn.disabled = true;
            btnText.innerHTML = '–û—Ç–ø—Ä–∞–≤–∫–∞ <span class="loading"></span>';
            
            try {
                // –ü–†–û–í–ï–†–ö–ê –ö–û–õ–õ–ò–ó–ò–ô: –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—â—ë —Ä–∞–∑ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–ª—è –ø–∞–∫–µ—Ç–∞)
                if (formData.consultationType !== 'package') {
                    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxX9Y_FN0YV54P-b3oTFUwmaszgQ2YGBJ9-US4s3MgAExHfDH8Ba7ZgKKkMjmdB7SEj/exec';
                    const checkResponse = await fetch(
                        `${GOOGLE_SCRIPT_URL}?action=checkAvailability&date=${formData.consultationDate}&clientOffset=${clientTimezoneOffset}`
                    );
                    
                    const checkData = await checkResponse.json();
                    
                    if (checkData.status === 'success') {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–ª–æ—Ç
                        if (!checkData.availableSlots.includes(formData.consultationTime)) {
                            errorMessage.textContent = '‚ö† –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ –≤—Ä–µ–º—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–Ω—è–ª–∏';
                            errorMessage.style.display = 'block';
                            errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                            const findFreeSlotContainer = document.getElementById('findFreeSlotContainer');
                            if (findFreeSlotContainer) {
                                findFreeSlotContainer.style.display = 'block';
                                findFreeSlotContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                            
                            return;
                        }
                    }
                }
                
                // Send to Google Sheets
                await sendToGoogleSheets(formData);
                
                // Create Google Calendar event
                await createGoogleCalendarEvent(formData);
                
                // Send to Telegram (optional)
                sendToTelegram(formData);
                
                // Show success
                successMessage.style.display = 'block';
                
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º, –ø–æ—Ç–æ–º —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
                successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–±—Ä–æ—Å–æ–º —Ñ–æ—Ä–º—ã
                setTimeout(() => {
                    form.reset();
                    
                    // –û—á–∏—â–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã
                    document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                    selectedTimeInput.value = '';
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ª–æ—Ç–æ–≤
                    const timeSlotsContainer = document.getElementById('timeSlotsContainer');
                    timeSlotsContainer.innerHTML = '<p style="color: var(--text-secondary); font-size: 14px; padding: 15px;">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ‚òùÔ∏è</p>';
                }, 300);
                
            } catch (error) {
                console.error('Error:', error);
                errorMessage.textContent = '‚ö† –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å –Ω–∞–ø—Ä—è–º—É—é.';
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } finally {
                submitBtn.disabled = false;
                btnText.textContent = '–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é';
            }
        });

        // Google Sheets Integration
        async function sendToGoogleSheets(data) {
            // –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à Google Apps Script Web App URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxX9Y_FN0YV54P-b3oTFUwmaszgQ2YGBJ9-US4s3MgAExHfDH8Ba7ZgKKkMjmdB7SEj/exec';
            
            const payload = {
                fullName: data.fullName,
                phone: data.phone,
                telegram: data.telegram,
                consultationType: data.consultationType,
                consultationDate: data.consultationDate,
                consultationTime: data.consultationTime, // –í–ê–®–ï –≤—Ä–µ–º—è
                clientTime: data.clientTime, // –í—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
                clientTimezone: data.clientTimezone, // –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
                comments: data.comments,
                timestamp: data.timestamp
            };
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets
            const response = await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload)
            });
            
            console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google Sheets:', payload);
            return Promise.resolve();
        }

        // Google Calendar Integration
        async function createGoogleCalendarEvent(data) {
            // –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç OAuth 2.0 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            // –î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Google Calendar API
            
            const eventDetails = {
                summary: `AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è - ${data.fullName}`,
                description: `
–ö–ª–∏–µ–Ω—Ç: ${data.fullName}
–¢–µ–ª–µ—Ñ–æ–Ω: ${data.phone}
Telegram: ${data.telegram}
–¢–∏–ø: ${data.consultationType}
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: ${data.comments}
                `.trim(),
                start: {
                    dateTime: `${data.consultationDate}T${data.consultationTime}:00`,
                    timeZone: 'Europe/Moscow'
                },
                end: {
                    dateTime: `${data.consultationDate}T${parseInt(data.consultationTime.split(':')[0]) + 1}:00:00`,
                    timeZone: 'Europe/Moscow'
                }
            };
            
            console.log('–°–æ–±—ã—Ç–∏–µ –¥–ª—è Google Calendar:', eventDetails);
            
            // –î–ª—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ - —Å–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
            const calendarUrl = createGoogleCalendarLink(data);
            console.log('–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å:', calendarUrl);
            
            return Promise.resolve();
        }

        // Create Google Calendar link
        function createGoogleCalendarLink(data) {
            const startDate = data.consultationDate.replace(/-/g, '');
            const startTime = data.consultationTime.replace(':', '') + '00';
            const endTime = (parseInt(data.consultationTime.split(':')[0]) + 1).toString().padStart(2, '0') + '0000';
            
            const params = new URLSearchParams({
                action: 'TEMPLATE',
                text: `AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è - ${data.fullName}`,
                dates: `${startDate}T${startTime}/${startDate}T${endTime}`,
                details: `–ö–ª–∏–µ–Ω—Ç: ${data.fullName}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${data.phone}\nTelegram: ${data.telegram}\n–¢–∏–ø: ${data.consultationType}`,
                location: 'Online'
            });
            
            return `https://calendar.google.com/calendar/render?${params.toString()}`;
        }

        // Telegram Integration
        function sendToTelegram(data) {
            const TELEGRAM_BOT_TOKEN = '8596783518:AAH7C8jheZC_95gFvZGDvLp6eH_v4hvYryE';
            const TELEGRAM_CHAT_ID = '7823521532';
            
            const message = `
üß† <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é!</b>

üë§ <b>–§–ò–û:</b> ${data.fullName}
üì± <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> ${data.phone}
üí¨ <b>Telegram:</b> ${data.telegram}

üìã <b>–¢–∏–ø:</b> ${data.consultationType}
üìÖ <b>–î–∞—Ç–∞:</b> ${data.consultationDate}

‚è∞ <b>–í–ê–®–ï –í–†–ï–ú–Ø:</b> ${data.consultationTime} (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, UTC+5)
üïê <b>–í—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞:</b> ${data.clientTime} (${data.clientTimezone})

üí≠ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b>
${data.comments || '–ù–µ —É–∫–∞–∑–∞–Ω'}

üïê <b>–ü–æ–ª—É—á–µ–Ω–æ:</b> ${new Date(data.timestamp).toLocaleString('ru-RU')}
            `.trim();
            
            // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
            
            fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            })
            .then(response => response.json())
            .then(data => console.log('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram:', data))
            .catch(error => console.error('–û—à–∏–±–∫–∞ Telegram:', error));
            
            
            console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram:', message);
        }
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è | –ù–µ–π—Ä–æ–≥—Ä–∞—Ñ–∏–∫–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #3b82f6;
            --secondary-color: #60a5fa;
            --accent-color: #2563eb;
            --bg-dark: #0a0a0f;
            --bg-card: #1a1a2e;
            --text-primary: #ffffff;
            --text-secondary: #b0b0c0;
            --border-glow: rgba(0, 245, 255, 0.3);
        }

        @keyframes backgroundShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 20px var(--border-glow); }
            50% { box-shadow: 0 0 40px var(--primary-color); }
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(124, 58, 237, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 0, 255, 0.1) 0%, transparent 50%);
            background-size: 100% 100%;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Neural network background - DISABLED for performance */
        .neural-bg {
            display: none;
        }

        .neural-node {
            display: none;
        }

        .container {
            background: rgba(26, 26, 46, 0.8);
            backdrop-filter: blur(20px);
            border-radius: 30px;
            border: 1px solid rgba(0, 245, 255, 0.2);
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.5),
                inset 0 0 60px rgba(0, 245, 255, 0.05);
            max-width: 600px;
            width: 100%;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .header {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.3) 0%, 
                rgba(0, 245, 255, 0.2) 100%);
            padding: 50px 40px;
            text-align: center;
            position: relative;
        }

        .ai-icon {
            font-size: 64px;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
            filter: drop-shadow(0 0 20px var(--primary-color));
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 12px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
        }

        .header p {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            position: relative;
        }

        .form-container {
            padding: 40px;
        }

        .benefits {
            background: linear-gradient(135deg, 
                rgba(124, 58, 237, 0.1) 0%, 
                rgba(0, 245, 255, 0.05) 100%);
            padding: 25px;
            border-radius: 20px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 245, 255, 0.2);
            position: relative;
        }

        .benefits h3 {
            color: var(--primary-color);
            margin-bottom: 18px;
            font-size: 18px;
            font-weight: 600;
            position: relative;
        }

        .benefits ul {
            list-style: none;
            padding: 0;
            position: relative;
        }

        .benefits li {
            padding: 10px 0;
            color: var(--text-secondary);
            position: relative;
            padding-left: 30px;
        }

        .benefits li::before {
            content: "‚óÜ";
            position: absolute;
            left: 0;
            color: var(--primary-color);
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-primary);
            font-weight: 500;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input, select, textarea {
            width: 100%;
            padding: 16px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 245, 255, 0.2);
            border-radius: 15px;
            font-size: 16px;
            color: var(--text-primary);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 
                0 0 20px rgba(0, 245, 255, 0.2),
                inset 0 0 20px rgba(0, 245, 255, 0.05);
        }

        input::placeholder, textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%2300f5ff'%3E%3Cpath d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 20px center;
            padding-right: 45px;
        }

        select option {
            background: var(--bg-card);
            color: var(--text-primary);
            padding: 10px;
        }

        .datetime-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .submit-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--accent-color), var(--primary-color));
            color: var(--text-primary);
            border: none;
            border-radius: 15px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .submit-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.2), 
                transparent);
            transition: left 0.5s ease;
        }

        .submit-btn:hover::before {
            left: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-3px);
            box-shadow: 
                0 15px 35px rgba(124, 58, 237, 0.4),
                0 0 30px var(--primary-color);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .message {
            padding: 18px;
            border-radius: 15px;
            margin-bottom: 25px;
            text-align: center;
            font-weight: 500;
            display: none;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .success-message {
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.2), 
                rgba(5, 150, 105, 0.2));
            border: 1px solid rgba(16, 185, 129, 0.5);
            color: #10b981;
        }

        .error-message {
            background: linear-gradient(135deg, 
                rgba(239, 68, 68, 0.2), 
                rgba(220, 38, 38, 0.2));
            border: 1px solid rgba(239, 68, 68, 0.5);
            color: #ef4444;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s linear infinite;
            margin-left: 10px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .info-text {
            font-size: 13px;
            color: var(--text-secondary);
            margin-top: 8px;
            font-style: italic;
        }

        .time-slot {
            display: inline-block;
            padding: 8px 16px;
            background: rgba(0, 245, 255, 0.1);
            border: 1px solid rgba(0, 245, 255, 0.3);
            border-radius: 10px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--text-secondary);
        }

        .time-slot:hover {
            background: rgba(0, 245, 255, 0.2);
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .time-slot.selected {
            background: var(--primary-color);
            color: var(--bg-dark);
            border-color: var(--primary-color);
        }

        .time-slots-container {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        @media (max-width: 600px) {
            .container {
                border-radius: 20px;
            }
            
            .header {
                padding: 40px 25px;
            }
            
            .header h1 {
                font-size: 26px;
            }
            
            .form-container {
                padding: 30px 25px;
            }

            .datetime-group {
                grid-template-columns: 1fr;
            }

            .ai-icon {
                font-size: 48px;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-color);
        }
    </style>
</head>
<body>
    <!-- Neural network background -->
    <div class="neural-bg" id="neuralBg"></div>

    <div class="container">
        <div class="header">
            <div class="ai-icon">üß†</div>
            <h1>AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è</h1>
            <p>–û—Ç–∫—Ä–æ–π—Ç–µ –º–∏—Ä –±–µ–∑–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –Ω–µ–π—Ä–æ–≥—Ä–∞—Ñ–∏–∫–∏</p>
        </div>
        
        <div class="form-container">
            <div class="benefits">
                <h3>‚óÜ –ß—Ç–æ –≤–∞—Å –∂–¥—ë—Ç</h3>
                <ul>
                    <li>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç—ã —Å AI</li>
                    <li>–ú–∞—Å—Ç–µ—Ä—Å—Ç–≤–æ –ø—Ä–æ–º–ø—Ç-–∏–Ω–∂–∏–Ω–∏—Ä–∏–Ω–≥–∞</li>
                    <li>–°–µ–∫—Ä–µ—Ç—ã —Å–æ–∑–¥–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏</li>
                    <li>–ü—Ä–∞–∫—Ç–∏–∫–∞ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö</li>
                    <li>–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –≤–∞—à–∏—Ö –Ω–∞–≤—ã–∫–æ–≤</li>
                </ul>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–∞—Ö -->
            <div class="benefits" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(96, 165, 250, 0.05) 100%);">
                <h3>‚è∞ –í—Ä–µ–º—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–π</h3>
                <p style="color: var(--text-secondary); margin-bottom: 15px;">
                    <strong style="color: var(--primary-color);">–†–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è:</strong> 10:00 - 20:00 (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, UTC+5)
                </p>
                <p style="color: var(--text-secondary); font-size: 14px;" id="timezoneInfo">
                    üìç –í–∞—à —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å: <span id="clientTimezone" style="color: var(--primary-color);">–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è...</span><br>
                    üïê –°–ª–æ—Ç—ã –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –≤–∞—à–µ–º –≤—Ä–µ–º–µ–Ω–∏
                </p>
            </div>

            <div class="success-message message" id="successMessage">
                ‚úì –ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!
            </div>

            <div class="error-message message" id="errorMessage">
                ‚ö† –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π.
            </div>

            <!-- 
            ============================================
            DEBUG INFO BLOCK - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù
            ============================================
            –≠—Ç–æ—Ç –±–ª–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram Mini App.
            –ü–æ–∫–∞–∑—ã–≤–∞–ª:
            - –û—Ç–∫—Ä—ã—Ç–∞ –ª–∏ —Ñ–æ—Ä–º–∞ –≤ Telegram –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–µ
            - User ID, Username, –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
            
            –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏:
            1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –Ω–∏–∂–µ
            2. –í JavaScript –Ω–∞–π–¥–∏—Ç–µ "debugInfo.style.display = 'block';" (—Å—Ç—Ä–æ–∫–∏ ~570 –∏ ~584)
            3. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —ç—Ç–∏ —Å—Ç—Ä–æ–∫–∏
            
            <div id="debugInfo" style="display: none; padding: 15px; background: rgba(59, 130, 246, 0.2); border-radius: 12px; margin-bottom: 20px; font-size: 14px; color: #60a5fa;"></div>
            -->

            <form id="consultationForm">
                <div class="form-group">
                    <label for="fullName">‚óÜ –§–ò–û</label>
                    <input 
                        type="text" 
                        id="fullName" 
                        name="fullName" 
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω–æ–µ –∏–º—è"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="phone">‚óÜ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                    <input 
                        type="tel" 
                        id="phone" 
                        name="phone" 
                        placeholder="+7 (999) 123-45-67"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="telegram">‚óÜ Telegram</label>
                    <input 
                        type="text" 
                        id="telegram" 
                        name="telegram" 
                        placeholder="@username"
                        required
                    >
                    <p class="info-text" id="telegramInfo">–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å @, –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤</p>
                </div>

                <div class="form-group">
                    <label for="consultationType">‚óÜ –¢–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</label>
                    <select id="consultationType" name="consultationType" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</option>
                        <option value="free">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è (30 –º–∏–Ω.) - 0‚ÇΩ</option>
                        <option value="basic">–ë–∞–∑–æ–≤–∞—è (1 —á–∞—Å) - –æ—Ç 3000‚ÇΩ</option>
                        <option value="advanced">–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è (2 —á–∞—Å–∞) - –æ—Ç 5000‚ÇΩ</option>
                        <option value="intensive">–ò–Ω—Ç–µ–Ω—Å–∏–≤ (4 —á–∞—Å–∞) - –æ—Ç 9000‚ÇΩ</option>
                        <option value="package">–ü–∞–∫–µ—Ç (5 –∑–∞–Ω—è—Ç–∏–π) - –æ—Ç 20000‚ÇΩ</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="consultationDate">‚óÜ –ñ–µ–ª–∞–µ–º–∞—è –¥–∞—Ç–∞</label>
                    <input 
                        type="date" 
                        id="consultationDate" 
                        name="consultationDate"
                        required
                    >
                    <p class="info-text">–í—ã–±–µ—Ä–∏—Ç–µ —É–¥–æ–±–Ω—É—é –¥–∞—Ç—É –¥–ª—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏</p>
                </div>

                <div class="form-group">
                    <label>‚óÜ –ñ–µ–ª–∞–µ–º–æ–µ –≤—Ä–µ–º—è</label>
                    <div class="time-slots-container" id="timeSlotsContainer">
                        <!-- –°–ª–æ—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã -->
                        <p style="color: var(--text-secondary); font-size: 14px; padding: 15px;">
                            –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ‚òùÔ∏è
                        </p>
                    </div>
                    <input type="hidden" id="selectedTime" name="selectedTime" required>
                    <p class="info-text">–°–ª–æ—Ç—ã –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –≤–∞—à–µ–º —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ</p>
                    
                    <!-- –ö–Ω–æ–ø–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å—ë –∑–∞–Ω—è—Ç–æ) -->
                    <div id="findFreeSlotContainer" style="display: none; margin-top: 15px;">
                        <button type="button" id="findFreeSlotBtn" style="
                            width: 100%;
                            padding: 12px;
                            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
                            color: white;
                            border: none;
                            border-radius: 12px;
                            font-size: 15px;
                            font-weight: 600;
                            cursor: pointer;
                            transition: all 0.3s ease;
                        ">
                            üîç –ù–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à–µ–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label for="comments">‚óÜ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
                    <textarea 
                        id="comments" 
                        name="comments" 
                        rows="3"
                        placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –æ —Å–≤–æ–∏—Ö —Ü–µ–ª—è—Ö –∏ –æ–∂–∏–¥–∞–Ω–∏—è—Ö –æ—Ç –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏..."
                    ></textarea>
                </div>

                <button type="submit" class="submit-btn" id="submitBtn">
                    <span id="btnText">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é</span>
                </button>
            </form>
        </div>
    </div>

    <script>
        // ============================================
        // TELEGRAM INTEGRATION
        // ============================================
        // TELEGRAM INTEGRATION
        // ============================================
        let tg = window.Telegram?.WebApp;
        let isTelegramApp = false;
        
        // DEBUG: –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É –Ω–∏–∂–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        // const debugInfo = document.getElementById('debugInfo');
        
        if (tg && tg.initData) {
            isTelegramApp = true;
            try {
                tg.ready();
                tg.expand();
            } catch (e) {}
            
            const user = tg.initDataUnsafe?.user;
            
            /* 
            ============================================
            DEBUG INFO DISPLAY - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù
            ============================================
            –≠—Ç–æ—Ç –∫–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ Telegram
            –Ω–∞ —Å–∞–º–æ–π —Ñ–æ—Ä–º–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.
            
            –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è –æ—Ç–ª–∞–¥–∫–∏:
            1. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ HTML –±–ª–æ–∫ debugInfo –≤—ã—à–µ (—Å—Ç—Ä–æ–∫–∞ ~450)
            2. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫—É "const debugInfo = ..." (—Å—Ç—Ä–æ–∫–∞ ~559)
            3. –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –±–ª–æ–∫–∏ –Ω–∏–∂–µ (—Å—Ç—Ä–æ–∫–∏ 571-577 –∏ 593-595)
            
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = `
                üì± <b>Telegram Mini App:</b> –î–ê<br>
                üë§ <b>User ID:</b> ${user?.id || '–Ω–µ—Ç'}<br>
                üî§ <b>Username:</b> ${user?.username ? '@' + user.username : '–ù–ï–¢ USERNAME'}<br>
                üìù <b>–ò–º—è:</b> ${user?.first_name || '–Ω–µ—Ç'} ${user?.last_name || ''}
            `;
            */
            
            // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Telegram
            setTimeout(() => {
                if (user?.username) {
                    telegramInput.value = '@' + user.username;
                }
                if (user?.first_name) {
                    const fullName = user.first_name + (user.last_name ? ' ' + user.last_name : '');
                    const nameInput = document.getElementById('fullName');
                    if (!nameInput.value) {
                        nameInput.value = fullName;
                    }
                }
            }, 300);
        } 
        /* 
        ============================================
        DEBUG –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞ - –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–ù
        ============================================
        else {
            debugInfo.style.display = 'block';
            debugInfo.innerHTML = 'üåê <b>–ë—Ä–∞—É–∑–µ—Ä:</b> —Ñ–æ—Ä–º–∞ –æ—Ç–∫—Ä—ã—Ç–∞ –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ';
        }
        */

        // ============================================
        // –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ß–ê–°–û–í–û–ì–û –ü–û–Ø–°–ê –ö–õ–ò–ï–ù–¢–ê
        // ============================================
        
        const MY_TIMEZONE_OFFSET = 300; // UTC+5 –≤ –º–∏–Ω—É—Ç–∞—Ö (5 * 60 = 300)
        const WORK_START_HOUR = 10; // –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è (–≤ –≤–∞—à–µ–º –≤—Ä–µ–º–µ–Ω–∏)
        const WORK_END_HOUR = 20;   // –ö–æ–Ω–µ—Ü —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
        
        // –ü–æ–ª—É—á–∞–µ–º —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –∫–ª–∏–µ–Ω—Ç–∞
        const clientTimezoneOffset = -new Date().getTimezoneOffset(); // –í –º–∏–Ω—É—Ç–∞—Ö
        const clientTimezoneName = Intl.DateTimeFormat().resolvedOptions().timeZone;
        
        // –†–∞–∑–Ω–∏—Ü–∞ –≤ —á–∞—Å–∞—Ö –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –≤–∞–º–∏
        const timeDifferenceMinutes = clientTimezoneOffset - MY_TIMEZONE_OFFSET;
        const timeDifferenceHours = timeDifferenceMinutes / 60;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ
        const clientTimezoneEl = document.getElementById('clientTimezone');
        if (clientTimezoneEl) {
            const utcOffset = clientTimezoneOffset / 60;
            const sign = utcOffset >= 0 ? '+' : '';
            clientTimezoneEl.textContent = `${clientTimezoneName} (UTC${sign}${utcOffset})`;
        }
        
        console.log('üåç –ß–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞:', {
            client: clientTimezoneName,
            clientOffset: clientTimezoneOffset,
            myOffset: MY_TIMEZONE_OFFSET,
            difference: timeDifferenceHours + ' —á–∞—Å–æ–≤'
        });
        
        // ============================================
        // –§–£–ù–ö–¶–ò–Ø –ö–û–ù–í–ï–†–°–ò–ò –í–†–ï–ú–ï–ù–ò
        // ============================================
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤–∞—à–µ –≤—Ä–µ–º—è –≤ –≤—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
        function convertMyTimeToClient(myHour) {
            return myHour + timeDifferenceHours;
        }
        
        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ –≤–∞—à–µ –≤—Ä–µ–º—è
        function convertClientTimeToMy(clientHour) {
            return clientHour - timeDifferenceHours;
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤—Ä–µ–º—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
        function formatTime(hour) {
            const h = Math.floor(hour);
            const m = Math.round((hour - h) * 60);
            return (h < 10 ? '0' : '') + h + ':' + (m < 10 ? '0' : '') + m;
        }

        // Form elements
        const form = document.getElementById('consultationForm');
        const submitBtn = document.getElementById('submitBtn');
        const btnText = document.getElementById('btnText');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        const phoneInput = document.getElementById('phone');
        const telegramInput = document.getElementById('telegram');
        const dateInput = document.getElementById('consultationDate');
        // const timeSlots = document.querySelectorAll('.time-slot'); // –ù–µ –Ω—É–∂–Ω–æ - —Å–ª–æ—Ç—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ
        const selectedTimeInput = document.getElementById('selectedTime');

        // Set minimum date to tomorrow (–∑–∞–ø–∏—Å—å –º–∏–Ω–∏–º—É–º –∑–∞ 24 —á–∞—Å–∞)
        const now = new Date();
        const tomorrow = new Date(now);
        tomorrow.setDate(tomorrow.getDate() + 1);
        
        const today = now.getFullYear() + '-' + 
                      String(now.getMonth() + 1).padStart(2, '0') + '-' + 
                      String(now.getDate()).padStart(2, '0');
        
        const minDate = tomorrow.getFullYear() + '-' + 
                        String(tomorrow.getMonth() + 1).padStart(2, '0') + '-' + 
                        String(tomorrow.getDate()).padStart(2, '0');
        
        dateInput.setAttribute('min', minDate);

        // ============================================
        // –û–ë–†–ê–ë–û–¢–ö–ê –ü–ê–ö–ï–¢–ù–û–ô –ö–û–ù–°–£–õ–¨–¢–ê–¶–ò–ò
        // ============================================
        const consultationTypeSelect = document.getElementById('consultationType');
        const timeSlotsContainer = document.getElementById('timeSlotsContainer');
        
        consultationTypeSelect.addEventListener('change', function() {
            if (this.value === 'package') {
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—Å–µ —Å–ª–æ—Ç—ã –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                timeSlotsContainer.innerHTML = `
                    <div style="
                        padding: 20px;
                        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(96, 165, 250, 0.05) 100%);
                        border-radius: 12px;
                        border: 1px solid rgba(59, 130, 246, 0.2);
                    ">
                        <p style="color: var(--primary-color); font-weight: 600; margin-bottom: 10px;">
                            üìû –ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ
                        </p>
                        <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                            –≠—Ç–æ—Ç —Ç–∏–ø –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ –æ–±—Å—É–∂–¥–∞–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É, –∏ –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è –¥–µ—Ç–∞–ª–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–µ –∑–∞–Ω—è—Ç–∏–π.
                        </p>
                    </div>
                `;
                selectedTimeInput.value = 'package'; // –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –ø–∞–∫–µ—Ç–∞
                selectedTimeInput.removeAttribute('required');
            } else {
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ã—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
                selectedTimeInput.value = '';
                selectedTimeInput.setAttribute('required', 'required');
                
                // –ï—Å–ª–∏ –¥–∞—Ç–∞ —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ª–æ—Ç—ã
                if (dateInput.value) {
                    const event = new Event('change', { bubbles: true });
                    dateInput.dispatchEvent(event);
                } else {
                    timeSlotsContainer.innerHTML = '<p style="color: var(--text-secondary); font-size: 14px; padding: 15px;">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ‚òùÔ∏è</p>';
                }
            }
        });

        // Phone formatting
        phoneInput.addEventListener('input', function(e) {
            let value = e.target.value.replace(/\D/g, '');
            
            if (value.length > 0) {
                if (value[0] === '7' || value[0] === '8') {
                    value = '7' + value.substring(1);
                } else if (value[0] !== '7') {
                    value = '7' + value;
                }
                
                let formatted = '+7';
                if (value.length > 1) {
                    formatted += ' (' + value.substring(1, 4);
                }
                if (value.length >= 5) {
                    formatted += ') ' + value.substring(4, 7);
                }
                if (value.length >= 8) {
                    formatted += '-' + value.substring(7, 9);
                }
                if (value.length >= 10) {
                    formatted += '-' + value.substring(9, 11);
                }
                
                e.target.value = formatted;
            }
        });

        // Telegram username validation
        telegramInput.addEventListener('input', function(e) {
            let value = e.target.value;
            
            if (value && !value.startsWith('@')) {
                value = '@' + value;
            }
            
            let username = value.substring(1);
            username = username.replace(/[^a-zA-Z0-9_]/g, '');
            
            if (username.length > 0 && /^\d/.test(username)) {
                username = username.substring(1);
            }
            
            e.target.value = username ? '@' + username : '';
            
            if (username.length >= 5) {
                e.target.style.borderColor = 'var(--primary-color)';
            } else if (username.length > 0) {
                e.target.style.borderColor = '#fbbf24';
            } else {
                e.target.style.borderColor = 'rgba(0, 245, 255, 0.2)';
            }
        });

        // ============================================
        // TIME SLOT HANDLERS
        // ============================================
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ —Ç–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
        // –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª–æ—Ç–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

        // ============================================
        // –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–û–°–¢–ò –°–õ–û–¢–û–í –° –ö–û–ù–í–ï–†–°–ò–ï–ô
        // ============================================
        dateInput.addEventListener('change', async function() {
            const selectedDate = this.value;
            if (!selectedDate) return;
            
            const timeSlotsContainer = document.getElementById('timeSlotsContainer');
            const findFreeSlotContainer = document.getElementById('findFreeSlotContainer');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            timeSlotsContainer.innerHTML = '<p style="color: var(--primary-color); font-size: 14px; padding: 15px;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤...</p>';
            timeSlotsContainer.style.opacity = '0.5';
            timeSlotsContainer.style.pointerEvents = 'none';
            findFreeSlotContainer.style.display = 'none';
            
            try {
                const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyF9bbu2p7XHkbsbeHWouJq5N07PQztBKSSdfkBSWsCGKfmVe_YRoqDiR3dv4OFSNGN/exec';
                const response = await fetch(
                    `${GOOGLE_SCRIPT_URL}?action=checkAvailability&date=${selectedDate}&clientOffset=${clientTimezoneOffset}`
                );
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    const now = new Date();
                    const currentHourClient = now.getHours();
                    const currentMinuteClient = now.getMinutes();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ –ª–∏ –ø—Ä–æ—à–ª–∞—è –¥–∞—Ç–∞
                    const selectedDateObj = new Date(selectedDate + 'T00:00:00');
                    const todayDateObj = new Date(today + 'T00:00:00');
                    const isPastDate = selectedDateObj < todayDateObj;
                    const isToday = selectedDate === today;
                    
                    // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–∞ –ø—Ä–æ—à–ª–∞—è –¥–∞—Ç–∞ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                    if (isPastDate) {
                        timeSlotsContainer.innerHTML = '<p style="color: #ef4444; font-size: 14px; padding: 15px;">‚ö†Ô∏è –ù–µ–ª—å–∑—è –≤—ã–±—Ä–∞—Ç—å –ø—Ä–æ—à–µ–¥—à—É—é –¥–∞—Ç—É</p>';
                        return;
                    }
                    
                    // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ —Å–ª–æ—Ç—ã
                    timeSlotsContainer.innerHTML = '';
                    
                    let freeCount = 0;
                    
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –í–°–ï —Å–ª–æ—Ç—ã (—Å–≤–æ–±–æ–¥–Ω—ã–µ + –∑–∞–Ω—è—Ç—ã–µ)
                    data.allSlots.forEach(myTimeSlot => {
                        const [myHour, myMinute] = myTimeSlot.split(':').map(Number);
                        
                        // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –≤—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
                        const clientHour = myHour + timeDifferenceHours;
                        const clientTime = formatTime(clientHour);
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–Ω—è—Ç–æ—Å—Ç—å –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ
                        const isBooked = data.bookedSlots.includes(myTimeSlot);
                        
                        let isDisabled = false;
                        let reason = '';
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –ó–∞–Ω—è—Ç–æ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ (–ü–†–ò–û–†–ò–¢–ï–¢)
                        if (isBooked) {
                            isDisabled = true;
                            reason = '–ó–∞–Ω—è—Ç–æ';
                        }
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –≤—Ä–µ–º—è - –º–µ–Ω—å—à–µ 24 —á–∞—Å–æ–≤ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞
                        // (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â—ë –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º)
                        if (!isDisabled) {
                            const slotDateTime = new Date(selectedDate + 'T' + formatTime(clientHour) + ':00');
                            const nowDateTime = new Date();
                            const timeDiffMs = slotDateTime - nowDateTime;
                            const timeDiffMinutes = timeDiffMs / (1000 * 60);
                            const timeDiffHours = timeDiffMinutes / 60;
                            
                            if (timeDiffHours < 24) {
                                isDisabled = true;
                                reason = timeDiffHours < 0 ? '–ü—Ä–æ—à–ª–æ' : '–ú–µ–Ω–µ–µ 24—á';
                            }
                        }
                        
                        // –°–æ–∑–¥–∞—ë–º —ç–ª–µ–º–µ–Ω—Ç —Å–ª–æ—Ç–∞
                        const slotEl = document.createElement('div');
                        slotEl.className = 'time-slot';
                        slotEl.setAttribute('data-time', myTimeSlot);
                        slotEl.setAttribute('data-client-time', clientTime);
                        slotEl.textContent = clientTime;
                        
                        if (isDisabled) {
                            slotEl.classList.add('disabled');
                            slotEl.style.opacity = '0.3';
                            slotEl.style.cursor = 'not-allowed';
                            slotEl.style.pointerEvents = 'none';
                            slotEl.title = reason;
                            
                            // –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –ø—Ä–∏—á–∏–Ω—ã
                            const reasonEl = document.createElement('span');
                            reasonEl.style.display = 'block';
                            reasonEl.style.fontSize = '11px';
                            reasonEl.style.marginTop = '2px';
                            reasonEl.style.color = '#ef4444';
                            reasonEl.textContent = reason;
                            slotEl.appendChild(reasonEl);
                        } else {
                            freeCount++;
                            slotEl.title = `–í–∞—à–µ –≤—Ä–µ–º—è: ${clientTime}\n–í—Ä–µ–º—è –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–∞: ${myTimeSlot} (UTC+5)`;
                            slotEl.addEventListener('click', function() {
                                if (this.classList.contains('disabled')) return;
                                
                                document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                                this.classList.add('selected');
                                selectedTimeInput.value = this.getAttribute('data-time');
                                selectedTimeInput.setAttribute('data-client-time', this.getAttribute('data-client-time'));
                            });
                        }
                        
                        timeSlotsContainer.appendChild(slotEl);
                    });
                    
                    // –ï—Å–ª–∏ –≤—Å–µ —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç—ã - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞
                    if (freeCount === 0) {
                        findFreeSlotContainer.style.display = 'block';
                    }
                    
                    console.log('‚úÖ –°–ª–æ—Ç—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã:', {
                        total: data.allSlots.length,
                        free: freeCount,
                        booked: data.bookedSlots.length
                    });
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:', error);
                timeSlotsContainer.innerHTML = '<p style="color: #ef4444; font-size: 14px; padding: 15px;">‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É.</p>';
            } finally {
                timeSlotsContainer.style.opacity = '1';
                timeSlotsContainer.style.pointerEvents = 'auto';
            }
        });

        // ============================================
        // –ü–û–ò–°–ö –ë–õ–ò–ñ–ê–ô–®–ï–ì–û –°–í–û–ë–û–î–ù–û–ì–û –í–†–ï–ú–ï–ù–ò
        // ============================================
        document.getElementById('findFreeSlotBtn').addEventListener('click', async function() {
            const btn = this;
            const originalText = btn.textContent;
            btn.disabled = true;
            btn.textContent = 'üîç –ü–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏...';
            
            try {
                const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyF9bbu2p7XHkbsbeHWouJq5N07PQztBKSSdfkBSWsCGKfmVe_YRoqDiR3dv4OFSNGN/exec';
                
                // –ò—â–µ–º –±–ª–∏–∂–∞–π—à—É—é —Å–≤–æ–±–æ–¥–Ω—É—é –¥–∞—Ç—É (–ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–ª–µ–¥—É—é—â–∏–µ 5 –¥–Ω–µ–π)
                const startDate = new Date(dateInput.value);
                let foundDate = null;
                let foundSlots = null;
                
                for (let i = 1; i <= 5; i++) {
                    const checkDate = new Date(startDate);
                    checkDate.setDate(checkDate.getDate() + i);
                    const dateStr = checkDate.getFullYear() + '-' + 
                                   String(checkDate.getMonth() + 1).padStart(2, '0') + '-' + 
                                   String(checkDate.getDate()).padStart(2, '0');
                    
                    const response = await fetch(
                        `${GOOGLE_SCRIPT_URL}?action=checkAvailability&date=${dateStr}&clientOffset=${clientTimezoneOffset}`
                    );
                    
                    const data = await response.json();
                    
                    if (data.status === 'success' && data.availableSlots.length > 0) {
                        foundDate = dateStr;
                        foundSlots = data;
                        break;
                    }
                }
                
                if (foundDate) {
                    // –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞–π–¥–µ–Ω–Ω—É—é –¥–∞—Ç—É
                    dateInput.value = foundDate;
                    
                    // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Å–æ–±—ã—Ç–∏–µ change –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ª–æ—Ç–æ–≤
                    const event = new Event('change', { bubbles: true });
                    dateInput.dispatchEvent(event);
                    
                    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Å–ª–æ—Ç–∞–º
                    document.getElementById('timeSlotsContainer').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'center' 
                    });
                } else {
                    alert('üòî –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤—Å–µ —Å–ª–æ—Ç—ã –∑–∞–Ω—è—Ç—ã –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 5 –¥–Ω–µ–π. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É –ø–æ–∑–∂–µ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å –Ω–∞–ø—Ä—è–º—É—é.');
                }
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞:', error);
                alert('‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É –≤—Ä—É—á–Ω—É—é.');
            } finally {
                btn.disabled = false;
                btn.textContent = originalText;
            }
        });

        // Form submission
        form.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Hide previous messages
            successMessage.style.display = 'none';
            errorMessage.style.display = 'none';
            
            // Get consultation type first
            const consultationType = document.getElementById('consultationType').value;
            
            // Validate time selection (skip for package)
            if (!selectedTimeInput.value && consultationType !== 'package') {
                errorMessage.textContent = '‚ö† –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏';
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            // Get form data
            const formData = {
                fullName: document.getElementById('fullName').value.trim(),
                phone: document.getElementById('phone').value.trim(),
                telegram: document.getElementById('telegram').value.trim(),
                consultationType: document.getElementById('consultationType').value,
                consultationDate: document.getElementById('consultationDate').value,
                consultationTime: selectedTimeInput.value, // –í–ê–®–ï –≤—Ä–µ–º—è (UTC+5)
                clientTime: selectedTimeInput.getAttribute('data-client-time') || selectedTimeInput.value, // –í—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
                clientTimezone: `${clientTimezoneName} (UTC${clientTimezoneOffset >= 0 ? '+' : ''}${clientTimezoneOffset / 60})`,
                clientTimezoneOffset: clientTimezoneOffset,
                comments: document.getElementById('comments').value.trim(),
                timestamp: new Date().toISOString()
            };
            
            // Validate
            if (!formData.fullName || !formData.phone || !formData.telegram || 
                !formData.consultationType || !formData.consultationDate) {
                errorMessage.textContent = '‚ö† –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è';
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–ª—è –ø–∞–∫–µ—Ç–∞)
            if (formData.consultationType !== 'package') {
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞—Ç—ã - –º–∏–Ω–∏–º—É–º –∑–∞–≤—Ç—Ä–∞
                const now = new Date();
                const selectedDateObj = new Date(formData.consultationDate + 'T00:00:00');
                const tomorrowDateObj = new Date(now);
                tomorrowDateObj.setDate(tomorrowDateObj.getDate() + 1);
                tomorrowDateObj.setHours(0, 0, 0, 0);
                
                if (selectedDateObj < tomorrowDateObj) {
                    errorMessage.textContent = '‚ö† –ó–∞–ø–∏—Å—å –≤–æ–∑–º–æ–∂–Ω–∞ –º–∏–Ω–∏–º—É–º –∑–∞ 24 —á–∞—Å–∞';
                    errorMessage.style.display = 'block';
                    errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ - –º–∏–Ω–∏–º—É–º 24 —á–∞—Å–∞ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞
                const [selectedHour, selectedMinute] = formData.consultationTime.split(':').map(Number);
                const consultationDateTime = new Date(formData.consultationDate + 'T' + formData.consultationTime + ':00');
                const timeDiffMs = consultationDateTime - now;
                const timeDiffHours = timeDiffMs / (1000 * 60 * 60);
                
                if (timeDiffHours < 24) {
                    errorMessage.textContent = '‚ö† –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–∏–Ω–∏–º—É–º 24 —á–∞—Å–∞ –¥–æ –Ω–∞—á–∞–ª–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏';
                    errorMessage.style.display = 'block';
                    errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    return;
                }
            }
            
            // Telegram username validation
            const telegramUsername = formData.telegram.substring(1);
            const telegramInfo = document.getElementById('telegramInfo');
            const telegramField = document.getElementById('telegram');
            
            if (!formData.telegram.startsWith('@') || telegramUsername.length < 5) {
                telegramInfo.textContent = '‚ö† –î–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å @ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤';
                telegramInfo.style.color = '#ef4444';
                telegramField.style.borderColor = '#ef4444';
                telegramField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            if (!/^[a-zA-Z0-9_]+$/.test(telegramUsername)) {
                telegramInfo.textContent = '‚ö† –¢–æ–ª—å–∫–æ –ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã –∏ _';
                telegramInfo.style.color = '#ef4444';
                telegramField.style.borderColor = '#ef4444';
                telegramField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }
            
            // –°–±—Ä–æ—Å —Å—Ç–∏–ª–µ–π –µ—Å–ª–∏ –≤—Å—ë –æ–∫
            telegramInfo.textContent = '–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å @, –º–∏–Ω–∏–º—É–º 5 —Å–∏–º–≤–æ–ª–æ–≤';
            telegramInfo.style.color = 'var(--text-secondary)';
            telegramField.style.borderColor = 'rgba(0, 245, 255, 0.2)';
            
            // Disable button and show loading
            submitBtn.disabled = true;
            btnText.innerHTML = '–û—Ç–ø—Ä–∞–≤–∫–∞ <span class="loading"></span>';
            
            try {
                // –ü–†–û–í–ï–†–ö–ê –ö–û–õ–õ–ò–ó–ò–ô: –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ—â—ë —Ä–∞–∑ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π (–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –¥–ª—è –ø–∞–∫–µ—Ç–∞)
                if (formData.consultationType !== 'package') {
                    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyF9bbu2p7XHkbsbeHWouJq5N07PQztBKSSdfkBSWsCGKfmVe_YRoqDiR3dv4OFSNGN/exec';
                    const checkResponse = await fetch(
                        `${GOOGLE_SCRIPT_URL}?action=checkAvailability&date=${formData.consultationDate}&clientOffset=${clientTimezoneOffset}`
                    );
                    
                    const checkData = await checkResponse.json();
                    
                    if (checkData.status === 'success') {
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–µ–Ω –ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–ª–æ—Ç
                        if (!checkData.availableSlots.includes(formData.consultationTime)) {
                            errorMessage.textContent = '‚ö† –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —ç—Ç–æ –≤—Ä–µ–º—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–Ω—è–ª–∏';
                            errorMessage.style.display = 'block';
                            errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            
                            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–∏—Å–∫–∞ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
                            const findFreeSlotContainer = document.getElementById('findFreeSlotContainer');
                            if (findFreeSlotContainer) {
                                findFreeSlotContainer.style.display = 'block';
                                findFreeSlotContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                            
                            return;
                        }
                    }
                }
                
                // Send to Google Sheets
                await sendToGoogleSheets(formData);
                
                // Create Google Calendar event
                await createGoogleCalendarEvent(formData);
                
                // Send to Telegram (optional)
                sendToTelegram(formData);
                
                // Show success
                successMessage.style.display = 'block';
                
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º, –ø–æ—Ç–æ–º —Å–±—Ä–∞—Å—ã–≤–∞–µ–º
                successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ —Å–±—Ä–æ—Å–æ–º —Ñ–æ—Ä–º—ã
                setTimeout(() => {
                    form.reset();
                    
                    // –û—á–∏—â–∞–µ–º –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã
                    document.querySelectorAll('.time-slot').forEach(s => s.classList.remove('selected'));
                    selectedTimeInput.value = '';
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–ª–æ—Ç–æ–≤
                    const timeSlotsContainer = document.getElementById('timeSlotsContainer');
                    timeSlotsContainer.innerHTML = '<p style="color: var(--text-secondary); font-size: 14px; padding: 15px;">–°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏ ‚òùÔ∏è</p>';
                }, 300);
                
            } catch (error) {
                console.error('Error:', error);
                errorMessage.textContent = '‚ö† –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑ –∏–ª–∏ —Å–≤—è–∂–∏—Ç–µ—Å—å –Ω–∞–ø—Ä—è–º—É—é.';
                errorMessage.style.display = 'block';
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } finally {
                submitBtn.disabled = false;
                btnText.textContent = '–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é';
            }
        });

        // Google Sheets Integration
        async function sendToGoogleSheets(data) {
            // –í–ê–ñ–ù–û: –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à Google Apps Script Web App URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyF9bbu2p7XHkbsbeHWouJq5N07PQztBKSSdfkBSWsCGKfmVe_YRoqDiR3dv4OFSNGN/exec';
            
            const payload = {
                fullName: data.fullName,
                phone: data.phone,
                telegram: data.telegram,
                consultationType: data.consultationType,
                consultationDate: data.consultationDate,
                consultationTime: data.consultationTime, // –í–ê–®–ï –≤—Ä–µ–º—è
                clientTime: data.clientTime, // –í—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞
                clientTimezone: data.clientTimezone, // –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å
                comments: data.comments,
                timestamp: data.timestamp
            };
            
            // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Google Sheets
            const response = await fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload)
            });
            
            console.log('–î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Google Sheets:', payload);
            return Promise.resolve();
        }

        // Google Calendar Integration
        async function createGoogleCalendarEvent(data) {
            // –≠—Ç–æ —Ç—Ä–µ–±—É–µ—Ç OAuth 2.0 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            // –î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Google Calendar API
            
            const eventDetails = {
                summary: `AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è - ${data.fullName}`,
                description: `
–ö–ª–∏–µ–Ω—Ç: ${data.fullName}
–¢–µ–ª–µ—Ñ–æ–Ω: ${data.phone}
Telegram: ${data.telegram}
–¢–∏–ø: ${data.consultationType}
–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: ${data.comments}
                `.trim(),
                start: {
                    dateTime: `${data.consultationDate}T${data.consultationTime}:00`,
                    timeZone: 'Europe/Moscow'
                },
                end: {
                    dateTime: `${data.consultationDate}T${parseInt(data.consultationTime.split(':')[0]) + 1}:00:00`,
                    timeZone: 'Europe/Moscow'
                }
            };
            
            console.log('–°–æ–±—ã—Ç–∏–µ –¥–ª—è Google Calendar:', eventDetails);
            
            // –î–ª—è —É–ø—Ä–æ—â—ë–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ - —Å–æ–∑–¥–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä—å
            const calendarUrl = createGoogleCalendarLink(data);
            console.log('–°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—å:', calendarUrl);
            
            return Promise.resolve();
        }

        // Create Google Calendar link
        function createGoogleCalendarLink(data) {
            const startDate = data.consultationDate.replace(/-/g, '');
            const startTime = data.consultationTime.replace(':', '') + '00';
            const endTime = (parseInt(data.consultationTime.split(':')[0]) + 1).toString().padStart(2, '0') + '0000';
            
            const params = new URLSearchParams({
                action: 'TEMPLATE',
                text: `AI –ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è - ${data.fullName}`,
                dates: `${startDate}T${startTime}/${startDate}T${endTime}`,
                details: `–ö–ª–∏–µ–Ω—Ç: ${data.fullName}\n–¢–µ–ª–µ—Ñ–æ–Ω: ${data.phone}\nTelegram: ${data.telegram}\n–¢–∏–ø: ${data.consultationType}`,
                location: 'Online'
            });
            
            return `https://calendar.google.com/calendar/render?${params.toString()}`;
        }

        // Telegram Integration
        function sendToTelegram(data) {
            const TELEGRAM_BOT_TOKEN = '8596783518:AAH7C8jheZC_95gFvZGDvLp6eH_v4hvYryE';
            const TELEGRAM_CHAT_ID = '7823521532';
            
            const message = `
üß† <b>–ù–æ–≤–∞—è –∑–∞—è–≤–∫–∞ –Ω–∞ AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é!</b>

üë§ <b>–§–ò–û:</b> ${data.fullName}
üì± <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> ${data.phone}
üí¨ <b>Telegram:</b> ${data.telegram}

üìã <b>–¢–∏–ø:</b> ${data.consultationType}
üìÖ <b>–î–∞—Ç–∞:</b> ${data.consultationDate}

‚è∞ <b>–í–ê–®–ï –í–†–ï–ú–Ø:</b> ${data.consultationTime} (–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥, UTC+5)
üïê <b>–í—Ä–µ–º—è –∫–ª–∏–µ–Ω—Ç–∞:</b> ${data.clientTime} (${data.clientTimezone})

üí≠ <b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</b>
${data.comments || '–ù–µ —É–∫–∞–∑–∞–Ω'}

üïê <b>–ü–æ–ª—É—á–µ–Ω–æ:</b> ${new Date(data.timestamp).toLocaleString('ru-RU')}
            `.trim();
            
            // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞
            
            fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CHAT_ID,
                    text: message,
                    parse_mode: 'HTML'
                })
            })
            .then(response => response.json())
            .then(data => console.log('–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ Telegram:', data))
            .catch(error => console.error('–û—à–∏–±–∫–∞ Telegram:', error));
            
            
            console.log('–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è Telegram:', message);
        }
    </script>
</body>
</html>
